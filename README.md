# Домашнее задание к занятию "`Репликация и масштабирование. Часть 2`" - `Попов Игорь`

---

### Задание 1

1. Активный master-сервер и пассивный репликационный slave-сервер.
- Минимальная сложность настройки и управления;
- Slave-сервер находится в режиме постоянной синхронизации с master-сервером и может быть быстро переведен в активный режим в случае сбоя основного сервера;
- Slave-сервер можно использовать для выполнения запросов на чтение, снижая нагрузку на master;
- Резервные копии можно создавать с slave-сервера, не прерывая работу master.

2. Master-сервер и несколько slave-серверов.
- Нагрузка распределяется между несколькими slave-серверами, что позволяет обрабатывать значительно больше запросов;
- Slave-серверы можно размещать в разных дата-центрах для снижения задержки для пользователей из разных регионов и повышения доступности;
- При сбое одного slave-сервера остальные продолжают работать, а система в целом сохраняет работоспособность.


### Задание 2.

1. Общая архитектура системы.
Горизонтальный шардинг (партиционирование по строкам) - разделение данных одной таблицы между несколькими серверами.

Вертикальный шардинг (разделение по столбцам/таблицам) - распределение таблиц/столбцов между разными серверами.

Сервер 1: users

Вертикальный шардинг:
- Таблица: пользователи (users)
Столбцы: id, email, username, password
  
Горизонтальный шардинг:
- Шард 1A: пользователи с id 1-100
- Шард 1B: пользователи с id 101-200
- Шард 1C: пользователи с id 201-300

Шардирования: по диапазонам id

Сервер 2: books

Вертикальный шардинг:
- Таблица: книги (books)
Столбцы: id, title, author, genre, price

Горизонтальный шардинг:
- Шард 2A: книги с genre 'Исторические'
- Шард 2B: книги с genre 'Худ. литература'
- Шард 2C: книги с genre 'Фантастика'

Шардирования: по жанрам

Сервер 3: stores

Вертикальный шардинг:
- Таблица: магазины (stores)
  Столбцы: id, name, location, manager, sales_data
  
Горизонтальный шардинг:
- Шард 3A: магазины с location 'Север города'
- Шард 3B: магазины с location 'Центр города'
- Шард 3C: магазины с location 'Юг города'

Шардирования: по району города

Блок схема

![Скриншот-1](https://github.com/garkitt/popov/blob/b1717ecc6fd23a68b0147504217e4f203608d283/img/SH-1.png)


Режимы работы серверов
1. Режим: Активный-активный (кластеризация)
- Маршрутизация запросов к нужным шардам
- Балансировка нагрузки
- Мониторинг состояния шардов
- Управление транзакциями между шардами

2. Мастер-реплика для каждого шарда
Шард XA: Мастер (запись/чтение) + 2 реплики (чтение)
Шард XB: Мастер (запись/чтение) + 2 реплики (чтение)
Шард XC: Мастер (запись/чтение) + 2 реплики (чтение)

- Хранение данных своего шарда
- Репликация на standby-серверы
- Автоматический failover при сбоях